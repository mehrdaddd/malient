"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var prosemirror_tables_1 = require("prosemirror-tables");
var prosemirror_utils_1 = require("prosemirror-utils");
var prosemirror_view_1 = require("prosemirror-view");
var main_1 = require("../pm-plugins/main");
exports.createHoverDecorationSet = function (cells, state, danger) {
    var deco = cells.map(function (cell) {
        var classes = ['hoveredCell'];
        if (danger) {
            classes.push('danger');
        }
        return prosemirror_view_1.Decoration.node(cell.pos - 1, cell.pos + cell.node.nodeSize - 1, {
            class: classes.join(' '),
        });
    });
    return prosemirror_view_1.DecorationSet.create(state.doc, deco);
};
exports.createControlsDecorationSet = function (editorView) {
    var pluginState = main_1.stateKey.getState(editorView.state);
    var tableNode = pluginState.tableNode;
    var start = prosemirror_utils_1.findTable(editorView.state.selection).pos;
    var before = start - 1;
    return prosemirror_view_1.DecorationSet.create(editorView.state.doc, [
        prosemirror_view_1.Decoration.node(before, before + tableNode.nodeSize, {
            class: "with-controls last-update-" + new Date().valueOf(),
        }),
    ]);
};
exports.createNumberColumnDecorationSet = function (state) {
    var table = prosemirror_utils_1.findTable(state.selection);
    if (!table || !table.node.attrs.isNumberColumnEnabled) {
        return null;
    }
    var start = prosemirror_utils_1.findTable(state.selection).pos;
    var map = prosemirror_tables_1.TableMap.get(table.node);
    var set = [];
    for (var i = 0, count = table.node.childCount; i < count; i++) {
        var cell = table.node.child(i).child(0);
        if (cell.type === state.schema.nodes.tableHeader) {
            continue;
        }
        var from = start + map.map[i * map.width];
        set.push(prosemirror_view_1.Decoration.node(from, from + cell.nodeSize, {
            contentEditable: false,
        }));
    }
    return prosemirror_view_1.DecorationSet.create(state.doc, set);
};
//# sourceMappingURL=decoration.js.map