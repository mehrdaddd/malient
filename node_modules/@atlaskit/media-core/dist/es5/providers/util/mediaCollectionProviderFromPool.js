"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Observable_1 = require("rxjs/Observable");
function mediaCollectionProviderFromPool(pool, poolId, createProvider) {
    return pool.acquire(poolId, function () {
        var provider = createProvider();
        var oldObservableFn = provider.observable;
        // wrap the observable to release the provider from the pool when we unsubscribe
        provider.observable = function () {
            return new Observable_1.Observable(function (observer) {
                var observable = oldObservableFn.bind(provider)();
                var subscription = observable.subscribe(observer);
                return function () {
                    subscription.unsubscribe();
                    pool.release(poolId);
                };
            });
        };
        return provider;
    });
}
exports.mediaCollectionProviderFromPool = mediaCollectionProviderFromPool;
//# sourceMappingURL=mediaCollectionProviderFromPool.js.map