"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var React = require("react");
var react_1 = require("react");
var classNames = require("classnames");
var add_1 = require("@atlaskit/icon/glyph/add");
var button_1 = require("@atlaskit/button");
var styles = require("./styles");
var EmojiButton_1 = require("../../components/common/EmojiButton");
var CachingEmoji_1 = require("../../components/common/CachingEmoji");
var ToneSelector_1 = require("./ToneSelector");
var EmojiPreview = /** @class */ (function (_super) {
    tslib_1.__extends(EmojiPreview, _super);
    function EmojiPreview() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.state = {
            selectingTone: false,
        };
        _this.onToneButtonClick = function () {
            _this.setState({
                selectingTone: true,
            });
        };
        _this.onToneSelected = function (toneValue) {
            _this.setState({
                selectingTone: false,
            });
            if (_this.props.onToneSelected) {
                _this.props.onToneSelected(toneValue);
            }
        };
        _this.onMouseLeave = function () {
            _this.setState({
                selectingTone: false,
            });
        };
        return _this;
    }
    EmojiPreview.prototype.renderTones = function () {
        var _this = this;
        var _a = this.props, toneEmoji = _a.toneEmoji, selectedTone = _a.selectedTone;
        if (!toneEmoji) {
            return null;
        }
        if (this.state.selectingTone) {
            return (React.createElement("div", { className: styles.toneSelectorContainer },
                React.createElement(ToneSelector_1.default, { emoji: toneEmoji, onToneSelected: this.onToneSelected })));
        }
        var previewEmoji = toneEmoji;
        if (selectedTone && previewEmoji.skinVariations) {
            previewEmoji = previewEmoji.skinVariations[(selectedTone || 1) - 1];
        }
        return (React.createElement("div", { className: styles.buttons },
            React.createElement(EmojiButton_1.default, { emoji: previewEmoji, 
                // tslint:disable-next-line:jsx-no-lambda
                onSelected: function () { return _this.onToneButtonClick(); }, selectOnHover: true })));
    };
    EmojiPreview.prototype.renderEmojiPreview = function () {
        var selectingTone = this.state.selectingTone;
        var _a = this.props, emoji = _a.emoji, uploadEnabled = _a.uploadEnabled;
        if (!emoji || selectingTone || uploadEnabled) {
            return null;
        }
        var previewClasses = classNames((_b = {},
            _b[styles.preview] = true,
            _b[styles.withToneSelector] = !!this.props.toneEmoji,
            _b));
        var previewTextClasses = classNames((_c = {},
            _c[styles.previewText] = true,
            _c[styles.previewSingleLine] = !emoji.name,
            _c));
        return (React.createElement("div", { className: previewClasses },
            React.createElement("span", { className: styles.previewImg },
                React.createElement(CachingEmoji_1.default, { emoji: emoji })),
            React.createElement("div", { className: previewTextClasses },
                React.createElement("span", { className: styles.name }, emoji.name),
                React.createElement("span", { className: styles.shortName }, emoji.shortName))));
        var _b, _c;
    };
    EmojiPreview.prototype.renderAddOwnEmoji = function () {
        var _a = this.props, onOpenUpload = _a.onOpenUpload, uploadEnabled = _a.uploadEnabled;
        var selectingTone = this.state.selectingTone;
        if (!uploadEnabled || selectingTone) {
            return null;
        }
        return (React.createElement("div", { className: styles.AddCustomEmoji },
            React.createElement(button_1.default, { onClick: onOpenUpload, iconBefore: React.createElement(add_1.default, { label: "add custom emoji", size: "small" }), appearance: "subtle", className: "emoji-picker-add-emoji" }, "Add your own emoji")));
    };
    EmojiPreview.prototype.render = function () {
        var sectionClasses = classNames([
            styles.emojiPreview,
            styles.emojiPreviewSection,
        ]);
        return (React.createElement("div", { className: sectionClasses, onMouseLeave: this.onMouseLeave },
            this.renderAddOwnEmoji(),
            this.renderEmojiPreview(),
            this.renderTones()));
    };
    return EmojiPreview;
}(react_1.PureComponent));
exports.default = EmojiPreview;
//# sourceMappingURL=EmojiPreview.js.map