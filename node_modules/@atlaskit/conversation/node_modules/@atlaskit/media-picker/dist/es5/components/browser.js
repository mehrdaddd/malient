"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var localUpload_1 = require("./localUpload");
var events_1 = require("../outer/analytics/events");
var Browser = /** @class */ (function (_super) {
    tslib_1.__extends(Browser, _super);
    function Browser(analyticsContext, context, browserConfig) {
        if (browserConfig === void 0) { browserConfig = { uploadParams: {} }; }
        var _this = _super.call(this, analyticsContext, context, browserConfig) || this;
        _this.onFilePicked = function () {
            var filesArray = [].slice.call(_this.browseElement.files);
            _this.uploadService.addFiles(filesArray);
        };
        _this.browseElement = document.createElement('input');
        _this.browseElement.setAttribute('type', 'file');
        _this.browseElement.style.display = 'none';
        if (browserConfig.multiple) {
            _this.browseElement.setAttribute('multiple', '');
        }
        if (browserConfig.fileExtensions) {
            _this.browseElement.setAttribute('accept', browserConfig.fileExtensions.join(','));
        }
        // IE11 hack - click will not execute if input has no parent
        // WebDriver hack - click will not execute if input isn't in the document
        document.body.appendChild(_this.browseElement);
        _this.addEvents();
        _this.analyticsContext.trackEvent(new events_1.MPBrowserLoaded());
        return _this;
    }
    Browser.prototype.addEvents = function () {
        if (this.config.useNewUploadService) {
            this.browseElement.addEventListener('change', this.onFilePicked);
        }
        else {
            this.uploadService.addBrowse(this.browseElement);
        }
    };
    Browser.prototype.removeEvents = function () {
        if (this.config.useNewUploadService) {
            this.browseElement.removeEventListener('change', this.onFilePicked);
        }
    };
    Browser.prototype.browse = function () {
        this.browseElement.click();
    };
    Browser.prototype.teardown = function () {
        this.removeEvents();
        var parentNode = this.browseElement.parentNode;
        if (parentNode) {
            parentNode.removeChild(this.browseElement);
        }
    };
    return Browser;
}(localUpload_1.LocalUploadComponent));
exports.Browser = Browser;
//# sourceMappingURL=browser.js.map