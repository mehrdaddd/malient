"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var prosemirror_inputrules_1 = require("prosemirror-inputrules");
var input_rules_1 = require("../../../utils/input-rules");
var analytics_1 = require("../../../analytics");
function inputRulePlugin(schema, typeAheads) {
    var triggers = typeAheads.map(function (t) { return t.trigger; }).join('|');
    if (!triggers.length) {
        return;
    }
    var regex = new RegExp("(^|[\\s(" + input_rules_1.leafNodeReplacementCharacter + "])(" + triggers + ")$");
    var typeAheadInputRule = input_rules_1.createInputRule(regex, function (state, match, start, end) {
        var mark = schema.mark('typeAheadQuery', { trigger: match[0] });
        var tr = state.tr;
        analytics_1.analyticsService.trackEvent('atlassian.fabric.mention.picker.trigger.shortcut');
        return tr.replaceSelectionWith(schema.text(match[0], [mark]), false);
    });
    return prosemirror_inputrules_1.inputRules({ rules: [typeAheadInputRule] });
}
exports.inputRulePlugin = inputRulePlugin;
exports.default = inputRulePlugin;
//# sourceMappingURL=input-rules.js.map