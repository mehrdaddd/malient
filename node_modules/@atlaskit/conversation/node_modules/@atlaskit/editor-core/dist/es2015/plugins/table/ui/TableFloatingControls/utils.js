import { toolbarSize } from './styles';
import { isRowSelected, isColumnSelected } from 'prosemirror-utils';
import { checkIfNumberColumnEnabled } from '../../utils';
var TABLE_PADDING = 10;
export var getLineMarkerWidth = function (tableElement, scroll) {
    var parentElement = tableElement.parentElement, offsetWidth = tableElement.offsetWidth;
    var diff = offsetWidth - parentElement.offsetWidth;
    var scrollDiff = scroll - diff > 0 ? scroll - diff : 0;
    return Math.min(offsetWidth + toolbarSize, parentElement.offsetWidth + TABLE_PADDING - scrollDiff);
};
// collect a range of selected rows, to figure out where to draw the delete button
// and hide the insert row buttons between
//
// assumes only a single contiguous range of rows can be selected
var findTableSelection = function (state, elems, isTableObjSelected, ignoreNumberColumn) {
    var startIdx = null;
    var endIdx = null;
    var inSelection = function (idx) {
        if (startIdx === null) {
            return false;
        }
        return idx >= startIdx && idx <= endIdx;
    };
    var frontOfSelection = function (idx) {
        if (startIdx === null) {
            return false;
        }
        return idx >= startIdx && idx < endIdx;
    };
    for (var i = ignoreNumberColumn && checkIfNumberColumnEnabled(state) ? 1 : 0, len = elems.length; i < len; i++) {
        if (isTableObjSelected(i)(state.selection)) {
            if (startIdx === null) {
                startIdx = i;
            }
        }
        else if (startIdx !== null && endIdx === null) {
            endIdx = i - 1;
        }
    }
    if (startIdx !== null && endIdx === null) {
        endIdx = elems.length - 1;
    }
    return {
        startIdx: startIdx,
        endIdx: endIdx,
        count: startIdx === null ? 0 : endIdx - startIdx + 1,
        hasMultipleSelection: startIdx !== null && startIdx !== endIdx,
        inSelection: inSelection,
        frontOfSelection: frontOfSelection,
    };
};
export var findRowSelection = function (state, elems) {
    return findTableSelection(state, elems, isRowSelected, false);
};
export var findColumnSelection = function (state, elems) {
    return findTableSelection(state, elems, isColumnSelected, false);
};
//# sourceMappingURL=utils.js.map