import * as tslib_1 from "tslib";
import * as React from 'react';
import { Provider, connect } from 'react-redux';
import Conversation from '../components/Conversation';
import { addComment, updateComment, deleteComment, revertComment, updateUser, createConversation, HIGHLIGHT_COMMENT, } from '../internal/actions';
import { getComments, getConversation, getUser } from '../internal/selectors';
import { uuid } from '../internal/uuid';
var mapStateToProps = function (state, ownProps) {
    var id = ownProps.id, localId = ownProps.localId, containerId = ownProps.containerId;
    var conversation = getConversation(state, id || localId);
    var comments = getComments(state, id || localId);
    var user = getUser(state);
    return tslib_1.__assign({}, ownProps, { conversation: conversation,
        comments: comments,
        containerId: containerId,
        user: user });
};
var mapDispatchToProps = function (dispatch, _a) {
    var provider = _a.provider;
    return ({
        onAddComment: function (conversationId, parentId, value, localId) {
            dispatch(addComment(conversationId, parentId, value, localId, provider));
        },
        onUpdateComment: function (conversationId, commentId, value) {
            dispatch(updateComment(conversationId, commentId, value, provider));
        },
        onDeleteComment: function (conversationId, commentId) {
            dispatch(deleteComment(conversationId, commentId, provider));
        },
        onRevertComment: function (conversationId, commentId) {
            dispatch(revertComment(conversationId, commentId, provider));
        },
        onHighlightComment: function (commentId) {
            dispatch({ type: HIGHLIGHT_COMMENT, payload: { commentId: commentId } });
        },
        onUpdateUser: function (user) {
            dispatch(updateUser(user, provider));
        },
        onCreateConversation: function (localId, containerId, value, meta) {
            dispatch(createConversation(localId, containerId, value, meta, provider));
        },
    });
};
var ResourcedConversation = connect(mapStateToProps, mapDispatchToProps)(Conversation);
var ConversationContainer = /** @class */ (function (_super) {
    tslib_1.__extends(ConversationContainer, _super);
    function ConversationContainer(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            localId: props.id || uuid.generate(),
        };
        return _this;
    }
    ConversationContainer.prototype.render = function () {
        var _a = this, props = _a.props, localId = _a.state.localId;
        var store = props.provider.store;
        return (React.createElement(Provider, { store: store },
            React.createElement(ResourcedConversation, tslib_1.__assign({}, props, { localId: localId }))));
    };
    return ConversationContainer;
}(React.Component));
export default ConversationContainer;
//# sourceMappingURL=Conversation.js.map