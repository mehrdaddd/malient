"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var util_shared_styles_1 = require("@atlaskit/util-shared-styles");
var serializers_1 = require("./serializers");
var util_1 = require("./util");
var editor_common_1 = require("@atlaskit/editor-common");
var serializeNode = function (node, serializedHTML) {
    // ignore nodes with unknown type
    if (!serializers_1.nodeSerializers[node.type.name]) {
        return "[UNKNOWN_NODE_TYPE: " + node.type.name + "]";
    }
    var attrs = node.type.name === 'table' ? getTableAttrs(node) : node.attrs;
    return serializers_1.nodeSerializers[node.type.name]({
        attrs: attrs,
        marks: node.marks,
        text: serializedHTML || node.attrs.text || node.attrs.shortName || node.text,
    });
};
var getTableAttrs = function (node) {
    return tslib_1.__assign({}, node.attrs, { columnWidths: editor_common_1.calcTableColumnWidths(node) });
};
var traverseTree = function (fragment) {
    var output = '';
    fragment.forEach(function (childNode) {
        if (childNode.isLeaf) {
            output += serializeNode(childNode);
        }
        else {
            var innerHTML = traverseTree(childNode.content);
            output += serializeNode(childNode, innerHTML);
        }
    });
    return output;
};
var wrapperCSS = util_1.serializeStyle({
    'font-family': util_shared_styles_1.akFontFamily,
    'font-size': util_shared_styles_1.akFontSizeDefault,
    'font-weight': 400,
    'line-height': '24px',
});
var EmailSerializer = /** @class */ (function () {
    function EmailSerializer() {
    }
    EmailSerializer.prototype.serializeFragment = function (fragment) {
        var innerHTML = traverseTree(fragment);
        return "<div style=\"" + wrapperCSS + "\">" + innerHTML + "</div>";
    };
    EmailSerializer.fromSchema = function (schema) {
        return new EmailSerializer();
    };
    return EmailSerializer;
}());
exports.default = EmailSerializer;
//# sourceMappingURL=index.js.map